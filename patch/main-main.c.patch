diff --git a/main/main.c b/main/main.c
index a9f66f2b..277a5fbe 100644
--- a/main/main.c
+++ b/main/main.c
@@ -22,9 +22,9 @@
 */
 #include "general.h"  /* must always come first */
 
-#if HAVE_DECL___ENVIRON
+#ifdef HAVE_DECL___ENVIRON
 #include <unistd.h>
-#elif HAVE_DECL__NSGETENVIRON
+#elif defined(HAVE_DECL__NSGETENVIRON)
 #include <crt_externs.h>
 #endif
 
@@ -120,8 +120,7 @@ static bool recurseUsingOpendir (const char *const dirName)
 	}
 	return resize;
 }
-
-#elif defined (HAVE__FINDFIRST)
+#endif
 
 static bool createTagsForWildcardEntry (
 		const char *const pattern, const size_t dirLength,
@@ -143,8 +142,8 @@ static bool createTagsForWildcardEntry (
 static bool createTagsForWildcardUsingFindfirst (const char *const pattern)
 {
 	bool resize = false;
-	const size_t dirLength = baseFilename (pattern) - pattern;
 #if defined (HAVE__FINDFIRST)
+	const size_t dirLength = baseFilename (pattern) - pattern;
 	struct _finddata_t fileInfo;
 	findfirst_t hFile = _findfirst (pattern, &fileInfo);
 	if (hFile != -1L)
@@ -160,9 +159,6 @@ static bool createTagsForWildcardUsingFindfirst (const char *const pattern)
 	return resize;
 }
 
-#endif
-
-
 static bool recurseIntoDirectory (const char *const dirName)
 {
 	static unsigned int recursionDepth = 0;
@@ -508,9 +504,9 @@ static void sanitizeEnviron (void)
 	char **e;
 	int i;
 
-#if HAVE_DECL___ENVIRON
+#ifdef HAVE_DECL___ENVIRON
 	e = __environ;
-#elif HAVE_DECL__NSGETENVIRON
+#elif defined(HAVE_DECL__NSGETENVIRON)
 	{
 		char ***ep = _NSGetEnviron();
 		if (ep)
